@{
    ViewData["Title"] = "Admin Dashboard";
}

<section class="mb-4">
    <p class="text-uppercase small text-muted mb-1">Admin area</p>
    <h1 class="h3 fw-semibold mb-2">Recipe Planner admin</h1>
    <p class="text-muted small mb-0">
        Review new recipes, handle reports, manage tags, and keep the community safe.
    </p>
</section>

<section class="row g-3 mb-4">
    <div class="col-md-3">
        <a class="soft-card h-100 d-block" href="/Admin/PendingRecipes">
            <h2 class="h6 mb-1">Pending recipes</h2>
            <p class="small text-muted mb-0">
                Approve or disable new user-submitted recipes.
            </p>
        </a>
    </div>

    <div class="col-md-3">
        <a class="soft-card h-100 d-block" href="/Admin/Reports">
            <h2 class="h6 mb-1">Reports & comments</h2>
            <p class="small text-muted mb-0">
                See content flagged by users and resolve reports.
            </p>
        </a>
    </div>

    <div class="col-md-3">
        <a class="soft-card h-100 d-block" href="/Admin/Tags">
            <h2 class="h6 mb-1">Tags & categories</h2>
            <p class="small text-muted mb-0">
                Merge duplicate tags and keep browsing tidy.
            </p>
        </a>
    </div>

    <div class="col-md-3">
        <a class="soft-card h-100 d-block" href="/Admin/Users">
            <h2 class="h6 mb-1">Users & moderation</h2>
            <p class="small text-muted mb-0">
                Warn or ban users who violate the rules.
            </p>
        </a>
    </div>
</section>

<section class="mt-4">
    <h2 class="h6 mb-3">Overview</h2>
    <div id="overviewCards" class="row g-3">
        <div class="col-md-3">
            <div class="soft-card text-center small">
                <p class="text-muted mb-1">Users</p>
                <div id="totalUsers" class="fs-4 fw-semibold">–</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="soft-card text-center small">
                <p class="text-muted mb-1">Recipes</p>
                <div id="totalRecipes" class="fs-4 fw-semibold">–</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="soft-card text-center small">
                <p class="text-muted mb-1">Approved recipes</p>
                <div id="totalApproved" class="fs-4 fw-semibold">–</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="soft-card text-center small">
                <p class="text-muted mb-1">Open reports</p>
                <div id="totalReports" class="fs-4 fw-semibold">–</div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                const res = await fetch("/api/admin/analytics/overview");
                if (!res.ok) return;

                const data = await res.json();
                document.getElementById("totalUsers").textContent = data.totalUsers;
                document.getElementById("totalRecipes").textContent = data.totalRecipes;
                document.getElementById("totalApproved").textContent = data.totalApprovedRecipes;
                document.getElementById("totalReports").textContent = data.totalReports;
            } catch (err) {
                console.error("Failed to load admin overview", err);
            }
        });
    </script>
}
